\ProvidesPackage{thesis}

\RequirePackage[font = small, labelfont = bf, textfont = it, singlelinecheck = false]{caption}
\RequirePackage[inner = 2.5cm, outer = 2.5cm, top = 2.5cm, bottom = 2.5cm]{geometry}
\RequirePackage[leftmargin = 16pt, rightmargin = 16pt, font = itshape]{quoting}
\RequirePackage[backend = biber, style = alphabetic, sorting = nyt]{biblatex}
\RequirePackage[unicode = true, hidelinks]{hyperref}

\RequirePackage[noheader, nopdfinfo]{gitver}
\RequirePackage[autostyle]{csquotes}
\RequirePackage[chapter]{tocbibind}
\RequirePackage[section]{placeins}
\RequirePackage[polish]{babel}

\RequirePackage{lualatex-math}
\RequirePackage{unicode-math}
\RequirePackage{indentfirst}
\RequirePackage{longtable}
\RequirePackage{emptypage}
\RequirePackage{setspace}
\RequirePackage{titlesec}
\RequirePackage{fontspec}
\RequirePackage{fancyhdr}
\RequirePackage{graphicx}
\RequirePackage{totcount}
\RequirePackage{multirow}
\RequirePackage{enumitem}
\RequirePackage{textcomp}
\RequirePackage{lmodern}
\RequirePackage{tocloft}
\RequirePackage{parskip}
\RequirePackage{gensymb}
\RequirePackage{siunitx}
\RequirePackage{comment}
\RequirePackage{calc}

\directlua{pdf.setminorversion(7)}

\makeatletter

\allowdisplaybreaks[1]
\babelprovide[transforms = oneletter.nobreak]{polish}

\titleformat{name=\chapter, numberless}[block]{\normalfont\bfseries}{}{0pt}{\Huge}
\titleformat{name=\chapter}[block]{\normalfont\bfseries}{}{0pt}{\Huge\thechapter.~}
\titleformat{name=\section}[block]{\normalfont\bfseries}{}{0pt}{\Large\thesection.~}

\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}} % for chapters
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} % for sections

\renewcommand{\cftchapaftersnum}{.} % for chapters
\renewcommand{\cftsecaftersnum}{.} % for sections
\renewcommand{\arraystretch}{1.30} % larger tables

\renewcommand\floatpagefraction{0.85}
\renewcommand\topfraction{0.85}
\renewcommand\bottomfraction{0.35}
\renewcommand\textfraction{0.25}

\newcommand{\hugelinespacing}{\renewcommand{\baselinestretch}{1.60} \normalsize}
\newcommand{\normallinespacing}{\renewcommand{\baselinestretch}{1.30} \normalsize}
\newcommand{\mediumlinespacing}{\renewcommand{\baselinestretch}{1.00} \normalsize}
\newcommand{\narrowlinespacing}{\renewcommand{\baselinestretch}{0.70} \normalsize}

\newcommand{\makecaption}[2]{\caption{\label{#1}#2}}
\newcommand{\emb}[1]{\left(#1\right)}
\newcommand{\bsigma}{ùõî}

\setenumerate{leftmargin = 32pt}
\setdescription{leftmargin = 32pt}

\setlength{\parskip}{12pt plus 5pt minus 2pt}
\setlength{\floatsep}{16pt plus 3pt minus 3pt}
\setlength{\intextsep}{16pt plus 3pt minus 3pt}
\setlength{\textfloatsep}{16pt plus 3pt minus 3pt}

\setlength{\parindent}{32pt}
\setlength{\headheight}{16pt}
\setlength{\tabcolsep}{6pt}
\setlength{\jot}{6pt}

\fancyhead{}
\fancyhead[EL]{\nouppercase{\small\leftmark}}
\fancyhead[OR]{\nouppercase{\small\@title}}

\fancyhead[ER]{\nouppercase{\small Wersja \gitVer{} z \@date}}

\def\maketitle
{
	\begin{titlepage}
		{\Large \bf Politechnika ≈ölƒÖska}
		\vskip 32pt
		{\Large Wydzia≈Ç Elektryczny \\ Katedra Metrologii, Elektroniki i Automatyki}
		\vskip 128pt
		{\Huge \bf Rozprawa Doktorska}
		\vskip 32pt
		{\Large \@title}
		\vskip 256pt
		{\Large \@author}
		\vfil
	\end{titlepage}
}

\def\titlepage
{
	\newpage
	\hugelinespacing
	\pagestyle{empty}
	\pagenumbering{alph}
	\centering
	\normalsize
	\vbox to \vsize
	\bgroup\bgroup
}

\def\endtitlepage
{
	\par
	\kern 0pt
	\egroup
	\vss
	\egroup
	\cleardoublepage
	\normallinespacing
}

\def\preface
{
	\cleardoublepage
	\hugelinespacing
	\pagenumbering{roman}
	\pagestyle{plain}
	\tableofcontents
	\cleardoublepage
	\normallinespacing
}

\def\appendix
{
	\cleardoublepage
	\mediumlinespacing
	\pagestyle{plain}
	\printbibliography[heading = bibintoc]
}

\def\body
{
	\cleardoublepage
	\normallinespacing
	\pagenumbering{arabic}
	\pagestyle{fancy}
}

\sisetup
{
	retain-explicit-plus = true,
	space-before-unit    = true,
	tight-spacing        = true,
	use-xspace           = true,
	per-mode             = fraction,
	inline-per-mode      = fraction,
	list-exponents       = combine-bracket,
	list-units           = single,
	range-exponents      = combine-bracket,
	range-units          = bracket,
	range-phrase         = \,;\,,
	quantity-product     = ~,
	exponent-product     = \cdot
}

% to avoid line breaks
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000
\tolerance=1
% --------------------

% to avoid widows and clubs
\widowpenalty=10000
\clubpenalty=10000
% --------------------

% to count chapters
\regtotcounter{chapter}
% --------------------

% for wider matrices
\setcounter{MaxMatrixCols}{15}
% --------------------

\makeatother
